<!-- Emergency AI Assistant - Add before </body> on each page -->
<div id="emergency-ai-button" style="
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 10000;
  background: #dc2626;
  color: white;
  border: none;
  border-radius: 50px;
  padding: 15px 20px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
  transition: all 0.3s ease;
" onclick="openEmergencyChat()">
  üö® Emergency Chat
</div>

<script>
function openEmergencyChat() {
  const overlay = document.createElement('div');
  overlay.id = 'emergency-chat-overlay';
  overlay.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    z-index: 20000;
    display: flex;
    justify-content: center;
    align-items: center;
  `;

  const chatContainer = document.createElement('div');
  chatContainer.style.cssText = `
    background: white;
    border-radius: 12px;
    width: 90%;
    max-width: 600px;
    height: 80%;
    max-height: 700px;
    position: relative;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
  `;

  const header = document.createElement('div');
  header.style.cssText = `
    background: #dc2626;
    color: white;
    padding: 20px;
    border-radius: 12px 12px 0 0;
    font-weight: 600;
    font-size: 18px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  `;
  header.innerHTML = 'üö® Emergency Restoration Assistant <button onclick="closeEmergencyChat()" style="background: rgba(255,255,255,0.2); border: none; color: white; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">√ó</button>';

  const emergencyInfo = document.createElement('div');
  emergencyInfo.style.cssText = `
    padding: 20px;
    background: #fef2f2;
    border-bottom: 1px solid #fecaca;
    text-align: center;
  `;
  emergencyInfo.innerHTML = `
    <div style="font-weight: 600; color: #dc2626; margin-bottom: 10px;">EMERGENCY PHONE NUMBERS</div>
    <div style="display: flex; justify-content: space-around; flex-wrap: wrap; gap: 10px; color: #1f2937;">
      <div><strong style="color: #1f2937;">Virginia:</strong> <a href="tel:703-844-4204" style="color: #dc2626; font-weight: 600;">703-844-4204</a></div>
      <div><strong style="color: #1f2937;">Maryland:</strong> <a href="tel:301-900-5171" style="color: #dc2626; font-weight: 600;">301-900-5171</a></div>
      <div><strong style="color: #1f2937;">DC:</strong> <a href="tel:202-796-7422" style="color: #dc2626; font-weight: 600;">202-796-7422</a></div>
    </div>
    <div style="margin-top: 10px; font-size: 14px; color: #1f2937; font-weight: 500;">‚è±Ô∏è Response Time: 60-90 minutes</div>
  `;

  const chatContent = document.createElement('div');
  chatContent.id = 'chat-content-area';
  chatContent.style.cssText = `
    flex: 1;
    padding: 20px;
    overflow-y: auto;
  `;
  chatContent.innerHTML = `
    <div style="background: #ffffff; padding: 15px; border-radius: 8px; margin-bottom: 15px; color: #1f2937; border: 2px solid #dc2626;">
      <strong style="color: #1f2937; font-weight: 700;">Hi! I'm your Emergency Restoration Assistant.</strong><br><br>
      <span style="color: #1f2937; font-weight: 600;">I'm here to help with:</span><br>
      <span style="color: #1f2937; font-weight: 500;">‚Ä¢ Water damage emergencies</span><br>
      <span style="color: #1f2937; font-weight: 500;">‚Ä¢ Fire and smoke damage</span><br>
      <span style="color: #1f2937; font-weight: 500;">‚Ä¢ Mold remediation</span><br>
      <span style="color: #1f2937; font-weight: 500;">‚Ä¢ Storm damage repair</span><br><br>
      <strong style="color: #1f2937; font-weight: 700;">What type of emergency are you experiencing?</strong>
    </div>
    <div id="chat-messages"></div>
    <div style="display: flex; gap: 10px; margin-top: 15px;">
      <button onclick="quickResponse('Water damage in my basement')" style="background: #dc2626; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; flex: 1;">üíß Water Damage</button>
      <button onclick="quickResponse('Fire damage to my property')" style="background: #dc2626; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; flex: 1;">üî• Fire Damage</button>
      <button onclick="quickResponse('Mold problem in my home')" style="background: #dc2626; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; flex: 1;">ü¶† Mold Issues</button>
    </div>
  `;

  chatContainer.appendChild(header);
  chatContainer.appendChild(emergencyInfo);
  chatContainer.appendChild(chatContent);
  overlay.appendChild(chatContainer);
  document.body.appendChild(overlay);

  overlay.addEventListener('click', function(e) {
    if (e.target === overlay) {
      closeEmergencyChat();
    }
  });
}

function closeEmergencyChat() {
  const overlay = document.getElementById('emergency-chat-overlay');
  if (overlay) {
    overlay.remove();
  }
}

function quickResponse(query) {
  const messagesDiv = document.getElementById('chat-messages');

  const userMsg = document.createElement('div');
  userMsg.style.cssText = 'background: #dc2626; color: white; padding: 10px; border-radius: 8px; margin-bottom: 10px; text-align: right;';
  userMsg.textContent = query;
  messagesDiv.appendChild(userMsg);

  setTimeout(() => {
    const chatContentArea = document.getElementById('chat-content-area');
    if (chatContentArea) {
      chatContentArea.scrollTo({
        top: chatContentArea.scrollHeight,
        behavior: 'smooth'
      });
    }
  }, 50);

  setTimeout(() => {
    const assistantMsg = document.createElement('div');
    assistantMsg.style.cssText = 'background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 10px; color: #1f2937; border: 1px solid #e5e7eb;';

    let response = '';
    if (query.includes('Water')) {
      response = `üö® <strong>WATER DAMAGE EMERGENCY</strong><br><br>
        <strong>CALL IMMEDIATELY:</strong><br>
        ‚Ä¢ Virginia: 703-844-4204<br>
        ‚Ä¢ Maryland: 301-900-5171<br>
        ‚Ä¢ DC: 202-796-7422<br><br>
        <strong>Immediate Steps:</strong><br>
        1. Stop water source if safely possible<br>
        2. Turn off electricity to affected areas<br>
        3. Remove valuable items from area<br>
        4. Take photos for insurance<br><br>
        A technician will arrive within 60-90 minutes.`;
    } else if (query.includes('Fire')) {
      response = `üî• <strong>FIRE DAMAGE EMERGENCY</strong><br><br>
        <strong>CALL IMMEDIATELY:</strong><br>
        ‚Ä¢ Virginia: 703-844-4204<br>
        ‚Ä¢ Maryland: 301-900-5171<br>
        ‚Ä¢ DC: 202-796-7422<br><br>
        <strong>Immediate Steps:</strong><br>
        1. Wait for fire department clearance<br>
        2. Do not enter unsafe areas<br>
        3. Secure property if possible<br>
        4. Contact insurance immediately<br><br>
        Emergency response team dispatched within 60-90 minutes.`;
    } else if (query.includes('Mold')) {
      response = `ü¶† <strong>MOLD REMEDIATION NEEDED</strong><br><br>
        <strong>CALL FOR ASSESSMENT:</strong><br>
        ‚Ä¢ Virginia: 703-844-4204<br>
        ‚Ä¢ Maryland: 301-900-5171<br>
        ‚Ä¢ DC: 202-796-7422<br><br>
        <strong>Immediate Steps:</strong><br>
        1. Avoid disturbing mold areas<br>
        2. Improve ventilation if safe<br>
        3. Document visible mold with photos<br>
        4. Keep children/pets away from area<br><br>
        Professional assessment within 24 hours.`;
    }

    assistantMsg.innerHTML = response;
    messagesDiv.appendChild(assistantMsg);

    setTimeout(() => {
      const chatContentArea = document.getElementById('chat-content-area');
      if (chatContentArea) {
        chatContentArea.scrollTo({
          top: chatContentArea.scrollHeight,
          behavior: 'smooth'
        });
      }

      messagesDiv.scrollTo({
        top: messagesDiv.scrollHeight,
        behavior: 'smooth'
      });
    }, 100);
  }, 1000);
}

document.addEventListener('DOMContentLoaded', function() {
  const button = document.getElementById('emergency-ai-button');

  button.addEventListener('mouseenter', function() {
    this.style.background = '#b91c1c';
    this.style.transform = 'scale(1.05)';
  });

  button.addEventListener('mouseleave', function() {
    this.style.background = '#dc2626';
    this.style.transform = 'scale(1)';
  });
});
</script>