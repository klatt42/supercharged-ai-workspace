name: BMAD Empire Multi-Region Deployment

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

env:
  BMAD_FRAMEWORK: "Authority Reversal"
  REGIONS: "Maryland,DC,Virginia"
  PHONE_MD: "301-900-5171"
  PHONE_DC: "202-796-7422"
  PHONE_VA: "703-844-4204"

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: Validate Regional Structure
      run: |
        echo "🔍 Validating BMAD regional structure..."
        ls -la regions/
        echo "✅ Maryland assets: $(ls regions/maryland/)"
        echo "✅ DC assets: $(ls regions/dc/)"
        echo "✅ Virginia assets: $(ls regions/virginia/)"
        
    - name: Validate Regional Pages
      run: |
        echo "🔍 Validating Authority Reversal regional pages..."
        test -f maryland-restoration.html && echo "✅ Maryland page ready"
        test -f dc-restoration.html && echo "✅ DC page ready"
        test -f virginia-restoration.html && echo "✅ Virginia page ready"
        
    - name: Validate Phone Integration
      run: |
        echo "🔍 Validating regional phone routing..."
        grep -q "301-900-5171" netlify.toml && echo "✅ Maryland phone routing configured"
        grep -q "202-796-7422" netlify.toml && echo "✅ DC phone routing configured"
        grep -q "703-844-4204" netlify.toml && echo "✅ Virginia phone routing configured"
        
    - name: Deploy to Netlify
      env:
        NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}
        NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}
      run: |
        echo "🚀 Elena Execution: Deploying BMAD Empire..."
        npm install -g netlify-cli
        netlify deploy --prod --dir=. --message="BMAD Authority Reversal ${{ github.sha }}"
        
    - name: Post-Deploy Validation
      run: |
        echo "✅ BMAD Empire Multi-Region Deployment Complete"
        echo "📊 Regional Phone Numbers Active:"
        echo "   Maryland: 301-900-5171"
        echo "   DC: 202-796-7422"  
        echo "   Virginia: 703-844-4204"
        echo "🎯 Authority Reversal Framework™ DEPLOYED"